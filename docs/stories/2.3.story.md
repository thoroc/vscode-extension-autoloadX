# Story 2.3: Update Extension Settings Storage Location

**As a** Developer, **I want** the extension settings to be saved in a prioritized order of locations, **so that** I can
ensure the most relevant settings are applied based on the project context.

## System Flow

This story is part of the extension settings management workflow. It ensures that settings are stored in prioritized
locations, improving security and performance. The updated storage location will align with the extension's overall
configuration strategy.

## Dependencies

- **Story 2.1**: Establishes the initial settings structure.
- **Story 2.2**: Implements user-defined settings overrides.

## Technical Implementation Details

- **Files to Modify**:
  - `src/services/settingsManager.ts`: Update logic for prioritized settings storage.
  - `src/services/migrationService.ts`: Implement seamless migration of existing settings.
- **APIs to Use**:
  - VSCode API for accessing `settings.json` and `.vscode` directories.
- **Data Models**:
  - Settings Metadata: Includes priority, location, and migration status.
- **Environment Variables**:
  - `SETTINGS_STORAGE_PATH`: Optional override for custom storage paths.

## References

- `docs/architecture/settings-priority.md`: Details on settings priority and storage locations.
- `docs/architecture/security-and-performance.md`: Guidelines for secure and performant storage.

## Acceptance Criteria

1. The extension settings are saved in one of the following locations, in order of priority:
   - **Local Repository**: Either in the `.vscode` directory within the project or the extension's own configuration
     file in the repository.
   - **Global Settings**: The `settings.json` file for VSCode.
   - **Extension Installation Directory**: As a fallback option.
2. The local repository settings always take the highest priority.
3. Existing settings are migrated seamlessly to the new location without data loss.
4. Users are notified of the change in settings storage location.
5. The new storage location adheres to the project's security and performance guidelines.
6. Unit and integration tests are updated to reflect the new storage location and priority order.
